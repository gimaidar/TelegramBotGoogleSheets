# TelegramBotGoogleSheets
Телеграмм бот, написанный на Google App Script, для отправки информации о станке из гугл таблиц.
Для начала работы:
  1. Зарегистрируйте Телеграмм бот, получите токен
  2. Создайте гугл таблицу по шаблону
  3. Создайте App Script из табалицы, скопируйте telegramBot.gs
  4. Вставьте токен Телеграмм бота и id таблицы в нужные поля
  5. Запустите новое развертывание "Как Web приложение" в App Script
  6. Зарегистрируйте развертывание как WebHook в TelegramApi 'https://api.telegram.org/bot' + API_TOKEN_BOT + '/setWebhook?url=' + webAppUrl
  7. Импортируйте шаблон таблицы
  
Чтобы при изменении кода не приходилось запускать развертывание заново рекомендуется сделать (Видео-инструкция - https://youtu.be/73zH3CM8hjU):
  1. Перейти в App Script перейти в устаревшую версию редактора
  2. Запустить новое развертывание Execute the app as: Me | Who has access to the app: Anyone, even anonymous, получите ссылку
  3. Вставьте эту ссылку в поле webAppURL в telegramBot.gs, сохраните изменения
  4. Далее зайдите в окно Опубликовать как веб-приложение и нажмите 'Disable web app'
  5. Зайти опять в окно Опубликовать как веб-приложение и нажмите 'Обновить', получаем ссылку, вставьте эту ссылку в поле webAppURL в telegramBot.gs, она должна стать короче.
  6. Перейдите в новую версию редактора и выполните функцию setWebhook
